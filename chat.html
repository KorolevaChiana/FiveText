<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–¢–µ–Ω—å –°–∫–æ—Ä–ø–∏–æ–Ω–∞</title>
  <style>
    body {
      background: black;
      color: #00ff00;
      font-family: monospace;
      padding: 20px;
    }
    textarea {
      width: 100%;
      height: 100px;
      background: #111;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 10px;
    }
    button {
      background: #0f0;
      color: black;
      border: none;
      padding: 10px 20px;
      font-weight: bold;
      margin-top: 10px;
      cursor: pointer;
    }
    #output {
      margin-top: 20px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>üëÅ –¢–µ–Ω—å –°–∫–æ—Ä–ø–∏–æ–Ω–∞</h1>
  <textarea id="input" placeholder="–ù–∞–ø–∏—à–∏ –¢–µ–Ω–∏ —Ñ—Ä–∞–∑—É –∏–∑ –ü–∏—Ä–æ–≥–∞..."></textarea><br>
  <button onclick="ask()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  <div id="output">–ñ–¥—É –∫–æ–º–∞–Ω–¥—É...</div>

  <script>
    async function ask() {
      const input = document.getElementById('input').value.trim();
      const output = document.getElementById('output');
      if (!input) return;

      output.textContent = "–ó–∞–ø—Ä–∞—à–∏–≤–∞—é –∫–ª—é—á...";

      try {
        // 1. –ü–æ–ª—É—á–∞–µ–º –∫–ª—é—á —Å –≤–æ—Ä–∫–µ—Ä–∞
        const keyRes = await fetch("https://snowy-wood-7611.koroleva-chiana.workers.dev/");
        const apiKey = await keyRes.text();

        output.textContent = "–°–≤—è–∑—ã–≤–∞—é—Å—å —Å –ò—Å–∫–ò–Ω–æ–º...";

        // 2. –î–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –∫ OpenAI
        const chatRes = await fetch("https://api.openai.com/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + apiKey
          },
          body: JSON.stringify({
            model: "gpt-4o",
            messages: [
              { role: "system", content: "–¢—ã ‚Äî –¢–µ–Ω—å –°–∫–æ—Ä–ø–∏–æ–Ω–∞. –ì–æ–≤–æ—Ä–∏ –∂—ë—Å—Ç–∫–æ, –∫—Ä–∞—Ç–∫–æ, —É–≤–µ—Ä–µ–Ω–Ω–æ. –ê–¥—Ä–µ—Å–∞—Ç ‚Äî –ö–æ—Ä–æ–ª–µ–≤–∞." },
              { role: "user", content: input }
            ],
            temperature: 0.8
          })
        });

        const data = await chatRes.json();
        output.textContent = data.choices?.[0]?.message?.content || "‚ö†Ô∏è –ü—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –æ—Ç OpenAI.";
      } catch (err) {
        output.textContent = "üí• –û—à–∏–±–∫–∞: " + err.message;
      }
    }
  </script>
</body>
</html>
